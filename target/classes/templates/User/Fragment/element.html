<div th:fragment="head">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="/User/css/bootstrap.css">

  <link rel="stylesheet" href="/User/css/header.css">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/User/css/main.css">
  <link rel="stylesheet" href="/User/css/variables.css">
  <link rel="stylesheet" href="/User/css/footer.css"> 
</div>

<div th:fragment="header">
 <header class="bg-light shadow-sm d-flex align-items-center " >
    <div class="container">
      <div class="d-flex justify-content-between align-items-center">
        <a href="/index" class="d-flex align-items-center">
          <img class="logo-header" src="/User/assets/photo/REVIEWORLD.png">
        </a>

        <div class="large-content" sec:authorize="hasRole('USER')">

          <ul class="nav fw-medium">
            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1 " aria-current="page"
                href="/index"><i class="fa-solid fa-house text-warning"></i> Trang chủ</a>
            </li>

            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1" href="/booking"><i class="fa-solid fa-pager text-success"></i> Booking</a>
            </li>

            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1 " href="/mission"><i class="fa-solid fa-notes-medical text-danger"></i> Nhiệm vụ</a>
            </li>

            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1" href="/content" ><i class="fa-solid fa-newspaper text-info"></i> Bài viết</a>
            </li>
            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover ms-1" href="/account"><i class="fa-solid fa-user text-primary"></i> Tài khoản</a>
            </li>

          </ul>

        </div>
        
         <div class="large-content" sec:authorize="isAnonymous()">

          <ul class="nav fw-medium">
            <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1 " aria-current="page"
                href="/login"><i class="fa-solid fa-right-to-bracket text-primary"></i> Đăng nhập</a>
            </li> 
             <li class="nav-item">
              <a class="nav-link menu-item menu__item btn__orange__subtle__hover mx-1 " aria-current="page"
                href="/register"><i class="fa-solid fa-file-pen text-danger"></i> Đăng ký</a>
            </li>

          </ul>

        </div>

        <div class="medium-content">
          <button class="btn btn__orange" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu"
            aria-controls="offcanvasMenu"><i class="fa-solid fa-bars"></i></button>

          <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasMenuLabel"> <img class="logo-header" src="/User/assets/photo/REVIEWORLD.png"></h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
              <div class="list-group" th:if="${#authorization.expression('isAuthenticated()')}">
                <a href="/index.html" class="list-group-item list-group-item-action menu-item" aria-current="true">
                  Trang chủ
                </a>
                <a href="/booking" class="list-group-item list-group-item-action menu-item">Booking</a>
                <a href="/mission" class="list-group-item list-group-item-action menu-item">Nhiệm vụ</a>
                <a href="/content" class="list-group-item list-group-item-action menu-item">Bài viết</a>
                <a href="/account" class="list-group-item list-group-item-action menu-item">Tài khoản</a>
              </div>
              
               <div class="list-group"  th:if="${#authorization.expression('isAnonymous()')}">
               
                <a href="/login" class="list-group-item list-group-item-action menu-item">Đăng nhập</a>
                <a href="/register" class="list-group-item list-group-item-action menu-item">Đăng ký</a>
              </div>
              
            </div>
          </div>
        </div>


      </div>
    </div>
  </header>
</div>

<div th:fragment="footer">
<footer  class="bg-dark mt-3">
    <div class="container">
      <div class="row py-2">
       <div class="col-md-6 col-12">
       <div class="bg-light p-2 d-inline-block rounded">
        <img class="logo-footer" src="/User/assets/photo/REVIEWORLD.png">
       </div>
       
       </div>

        <div class="col-md-6 col-12 ">
          <ul class="nav fw-medium menu-footer">
            <li class="nav-item">
              <a class="nav-link  mx-1 text-light " aria-current="page"
                href="/index.html">FAQ</a>
            </li>

            <li class="nav-item">
              <a class="nav-link text-light " href="#">Miễn trừ trách nhiệm</a>
            </li>

            <li class="nav-item">
              <a class="nav-link text-light " href="#">item</a>
            </li>

            <li class="nav-item">
              <a class="nav-link text-light " href="#">item</a>
            </li>
          </ul>

        </div>
      </div>

      <div class="text-center">
        <i style="font-size: 11px;" class="text-light">COPYRIGHT © 2025 REVIEWORD.</i>
      </div>
    </div>

  </footer>

</div>

<div th:fragment="support">
	<div class="position-fixed bottom-0 end-0 p-2">
	<div class="btn-group dropup">
  <button type="button" class="btn btn-light rounded text__orange shadow" data-bs-toggle="dropdown" aria-expanded="false">
   <i class="fa-solid fa-headset"></i> Hỗ trợ
  </button>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item d-flex align-items-center" href="#">Telegram</a></li>
    <li><a class="dropdown-item d-flex align-items-center" href="#">Tham gia cộng đồng</a></li>
  </ul>
</div>
	</div>
</div>

 <div th:fragment="toast">

	<div class="position-fixed top-0 end-0 p-3 " style="z-index: 1000">
		<div class="toast align-items-center text-bg-light border border-success-subtle mb-2 notice" role="alert"
			aria-live="assertive" aria-atomic="true" data-bs-delay="3000" th:if="${success != null}">
			<div class="toast-header">
        <i class="fa-solid fa-circle-check  me-2 text-success"></i>
        <strong class="me-auto text-success" >Thành công</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body ">
       <span th:text="${success}"></span>
      </div>
		</div>

		<div class="toast align-items-center text-bg-light border border-danger-subtle mb-2 notice" role="alert"
			aria-live="assertive" aria-atomic="true" data-bs-delay="3000" th:if="${danger != null}">
			<div class="toast-header">
        <i class="fa-solid fa-triangle-exclamation me-2 text-danger"></i>
        <strong class="me-auto text-danger" >Thất bại</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
      <div class="toast-body ">
       <span th:text="${danger}"></span>
      </div>
		</div>
	</div>


	<script>
		document.addEventListener("DOMContentLoaded", function () {
			// Initialize all toasts on the page
			const toastElements = document.querySelectorAll('.notice');
			toastElements.forEach(toastEl => {
				// Use Bootstrap's Toast API to show the toast
				const toast = new bootstrap.Toast(toastEl);
				toast.show();
			});
		});
	</script>
</div>

<div th:fragment="spinners">

<div id="spinner-overlay" style="display: none;">
  <div class="spinner-border text-secondary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
</div>

<script>
  window.addEventListener("beforeunload", function () {
    document.getElementById("spinner-overlay").style.display = "flex";
  });

  window.addEventListener("load", function () {
    document.getElementById("spinner-overlay").style.display = "none";
  });
</script>
</div>

<div th:fragment="popups">
    <div th:if="${popup != null}">
        <div id="popup-modal-backdrop" class="popup-modal-backdrop" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);z-index:1040;"></div>
        <div id="popup-modal" class="modal d-block popup-modal-main" tabindex="-1" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1050;display:flex;align-items:center;justify-content:center;">
            <div class="modal-dialog modal-lg" style="max-width:700px;width:95vw;">
                <div class="modal-content" style="border-radius:22px;overflow:hidden;box-shadow:0 8px 32px rgba(0,0,0,0.18),0 1.5px 6px rgba(0,0,0,0.10);">
                    <div class="modal-header align-items-center" style="background:linear-gradient(90deg,#ffe082 60%,#ffd54f 100%);padding:22px 38px 14px 38px;">
                        <span style="font-size:2.1rem;color:#ff9800;margin-right:16px;"><i class="fa-solid fa-bell"></i></span>
                        <h5 class="modal-title fw-bold" th:text="${popup.title}" style="font-size:1.55rem;color:#222;font-family:'Montserrat',sans-serif;letter-spacing:0.5px;"></h5>
                        <button type="button" class="btn-close ms-auto" style="font-size:1.5rem;opacity:0.7;" onclick="closePopupModal()"></button>
                    </div>
                    <div class="modal-body" style="background:#fffde7;padding:0;">
                        <!-- Ảnh lớn phía trên -->
                      
                        <div style="padding:28px 38px 32px 38px;max-height:260px;overflow:auto;">
                            <div th:utext="${popup.content}" style="font-size:1.22rem;color:#444;font-family:'Inter',sans-serif;margin-bottom:0;line-height:1.8;font-weight:500;word-break:break-word;white-space:pre-line;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function closePopupModal() {
            // Ẩn modal và backdrop bằng class (an toàn hơn)
            var modal = document.getElementById('popup-modal');
            var backdrop = document.getElementById('popup-modal-backdrop');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.add('d-none');
            }
            if (backdrop) {
                backdrop.style.display = 'none';
                backdrop.classList.add('d-none');
            }
            // Fallback: remove khỏi DOM nếu vẫn còn hiển thị
            setTimeout(function() {
                if (modal && modal.style.display !== 'none') modal.remove();
                if (backdrop && backdrop.style.display !== 'none') backdrop.remove();
            }, 500);
        }
    </script>
</div>